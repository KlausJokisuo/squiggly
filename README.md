# Squiggly


<a href="https://github.com/KlausJokisuo/squiggly/actions">
  <img src="https://img.shields.io/github/actions/workflow/status/KlausJokisuo/squiggly/main.yml?style=flat&logo=github&label=workflow" alt="GitHub Actions">
</a>
<a href="https://pub.dev/packages/squiggly">
  <img src="https://img.shields.io/pub/v/squiggly.svg?style=flat&logo=dart&label=pub" alt="pub package">
</a>
<a href="https://opensource.org/licenses/MIT">
  <img src="https://img.shields.io/badge/License-MIT-yellow.svg?style=flat&logo=opensource" alt="License: MIT">
</a>
<a href="https://github.com/KlausJokisuo/squiggly">
  <img src="https://img.shields.io/github/stars/KlausJokisuo/squiggly.svg?style=flat&logo=github&label=stars" alt="Star on GitHub">
</a>

A Dart analyzer plugin that provides IDE assists and lint rules.

## Features

### IDE Assists

Squiggly provides quick-fix assists accessible via your IDE's action menu:

| Assist                                  | Description                                                                    |
|-----------------------------------------|--------------------------------------------------------------------------------|
| **Add equality and hashCode overrides** | Generates `==` operator and `hashCode` getter based on all class fields        |
| **Add toString override**               | Generates a `toString()` method that includes all class fields                 |
| **Add copyWith method**                 | Generates a null-safe `copyWith()` method based on constructor parameters      |
| **Implement Data class methods**        | Adds all missing data class methods (`==`, `hashCode`, and `copyWith`) at once |

### Lint Rules

Squiggly detects when your data class methods are out of sync with your class fields:

| Rule                  | Description                                             |
|-----------------------|---------------------------------------------------------|
| `equality_incomplete` | Warns when `==` or `hashCode` is missing fields         |
| `copywith_incomplete` | Warns when `copyWith` is missing constructor parameters |
| `tostring_incomplete` | Warns when `toString` is missing fields                 |

Each lint rule comes with a quick-fix to automatically update the method to include all fields.

## Installation

Add `squiggly` as a dev dependency in your `pubspec.yaml`:

```yaml
dev_dependencies:
  squiggly: ^1.0.4
```

Then configure the plugin in your `analysis_options.yaml`:

```yaml
plugins:
  squiggly:
    version: ^1.0.4
    diagnostics:
      equality_incomplete: true
      copywith_incomplete: true
      tostring_incomplete: true
```

## Usage

### Generated Code Examples

#### Equality & HashCode

```dart
import 'package:collection/collection.dart';

class Person {
  final String name;
  final int age;
  final List<String> hobbies;

  Person(this.name, this.age, this.hobbies);

  // Generated by "Add equality and hashCode overrides"
  @override
  bool operator ==(Object other) =>
      identical(this, other) ||
      other is Person &&
          name == other.name &&
          age == other.age &&
          const DeepCollectionEquality().equals(hobbies, other.hobbies);

  @override
  int get hashCode => Object.hash(
      name, age, const DeepCollectionEquality().hash(hobbies));
}
```

> **Note:** When your class contains list, set, or map fields, Squiggly automatically imports and uses `DeepCollectionEquality` from the `collection` package for proper equality comparison. Make sure to add `collection` to your pubspec.yaml dependencies.

#### ToString

```dart
class Person {
  final String name;
  final int age;

  Person(this.name, this.age);

  // Generated by "Add toString override"
  @override
  String toString() {
    return 'Person{name: $name, age: $age}';
  }
}
```

#### CopyWith

Squiggly generates a null-safe `copyWith` using record types, allowing you to explicitly set nullable fields to `null`:

```dart
class Person {
  final String? name;
  final int age;

  Person({this.name, required this.age});

  // Generated by "Add copyWith method"
  Person copyWith({
    ({String? value})? name,
    ({int value})? age,
  }) {
    return Person(
      name: name == null ? this.name : name.value,
      age: age == null ? this.age : age.value,
    );
  }
}

// Usage:
final person = Person(name: 'Alice', age: 30);

// Update a field
final updated = person.copyWith(age: (value: 31));

// Set a nullable field to null explicitly
final cleared = person.copyWith(name: (value: null));

// Copy without changes
final copy = person.copyWith();
```

### Incomplete Method Detection

When you add a new field to your class, Squiggly will warn you if your existing methods don't include it:

```dart
class Person {
  final String name;
  final int age;
  final String email; // New field added

  Person(this.name, this.age, this.email);

  @override
  bool operator ==(Object other) =>  // ⚠️ equality_incomplete: All fields should be included in equality and hashCode: email
      identical(this, other) ||
      other is Person && name == other.name && age == other.age;

  @override
  int get hashCode => Object.hash(name, age); // ⚠️ equality_incomplete: All fields should be included in equality and hashCode: email

  @override
    String toString() {
    return 'Person{name: $name, age: $age}'; // ⚠️ tostring_incomplete: All fields should be included in toString: email
  }
}
```

Use the quick-fix to automatically update the methods with the missing fields.

## Requirements

- Dart SDK `^3.10.0`

## License

MIT License - see [LICENSE](LICENSE) for details.

